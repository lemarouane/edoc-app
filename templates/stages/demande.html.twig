{% extends 'template.html.twig' %}
    {% block title %}{{'stages'|trans}}{% endblock %}
    {% block stylesheets %}
        {{ parent() }}
        <link href="{{ asset('uploads/css/bootstrap-material-datetimepicker1.min.css') }}" rel="stylesheet" >
    {% endblock %}
    {% block body %}
<h6 class="mb-0 text-uppercase">{{'dem_stage'|trans}}</h6>
<hr/>
            <!--end breadcrumb-->

  
              <div class="row">
                 <div class="col-lg-12 mx-auto">
                 {% include "flaches.html.twig" %}
                  <div class="card">
                    <div class="card-body">
                       <div class="row g-3">
                         <div class="col-12 col-lg-12">
                            <div class="card shadow-none bg-light border">
                              <div class="card-body">
                                {% if page == 'new' %}
                                  {{ form_start(form, {'action': path('conventionDemande'), 'method': 'POST' ,'attr' : {class: 'row g-2' ,'enctype' : 'multipart/form-data'}}) }}
                                {% else %}
                                  {{ form_start(form, {'action': path('updateStage',{id: stage.id}), 'method': 'POST' ,'attr' : {class: 'row g-2' ,'enctype' : 'multipart/form-data'}}) }}           
                                {% endif %} 
                                  <div class="col-12 col-lg-6">
                                    {{ form_label(form.entreprise) }}
                                    {{ form_widget(form.entreprise) }}
                                  </div>
                                  <div id="divstage_intitule" class="col-12 col-lg-6">
                                    {{ form_label(form.intitule) }}
                                    {{ form_widget(form.intitule) }}
                                  </div>
                                  <div class="col-12 col-lg-6">
                                    {{ form_label(form.dateDebut) }}
                                    {{ form_widget(form.dateDebut) }}
                                  </div>
                                  <div class="col-12 col-lg-6">
                                    {{ form_label(form.dateFin) }}
                                    {{ form_widget(form.dateFin) }}
                                  </div>
                                  <div class="col-12 col-lg-6">
                                    {{ form_label(form.typeStage) }}
                                    {{ form_widget(form.typeStage) }}
                                  </div>
                                  <div class="col-12 col-lg-6">
                                    {{ form_label(form.phone) }}
                                    {{ form_widget(form.phone) }}
                                  </div>
                                  <div class="col-12 col-lg-6">
                                    {{ form_label(form.fichier) }}
                                    {{ form_widget(form.fichier) }}
                                  </div>
                                  <div class="col-12">
                                    {{ form_label(form.sujet) }}
                                    {{ form_widget(form.sujet) }}
                                  </div>
                                  <div class="d-grid">
                                    
                                    <button type="submit" class="btn btn-block btn-success radius-30">{{'valider'|trans}}</button>
                                  </div> 
                                {{ form_row(form._token) }}
                                {{ form_end(form , {'render_rest': false}) }}
                              </div>
                            </div>
                         </div>
                       </div><!--end row-->
                     </div>
                   </div>
                    <h6 class="mb-0 text-uppercase">{{'liste_stage'|trans}}</h6>
                       <hr/>
                     <div class="card">
                    <div class="card-body">
                        
                        <div class="table-responsive">
                          <table id="example" class="table table-striped table-bordered" style="text-align:center !important ;">
                            <thead>
                              <tr>
                    
                                <th style="text-align:center !important ;">{{'entreprise'|trans}}</th>
              
                                <th style="text-align:center !important ;">{{'date_debut'|trans}}</th>
                                <th style="text-align:center !important ;">{{'date_fin'|trans}}</th>
                                <th style="text-align:center !important ;">{{'type'|trans}}</th>
                                <th style="text-align:center !important ;">{{'date_envoie'|trans}}</th>
                                <th style="text-align:center !important ;">{{'statut'|trans}}</th>
                                <th style="text-align:center !important ;">{{'niveau'|trans}}</th>
                                <th style="text-align:center !important ;">{{'motif_refus'|trans}}</th>
                                <th style="text-align:center !important ;">{{'op'|trans}}</th>
                              </tr>
                            </thead>
                            <tbody>
                              {% for st in stages %}
                                <tr 
                                {% if stage is defined %}
     {{  st.id  == stage.id ? 'style="background-color:#ADD8E6;"' }}
                                {% endif %}
                                  >
                                  <td>



                                  {% if st.entreprise  is not empty  %} {% if st.entreprise.intitule == 'autre' %} {{st.intitule}}  {% else %} {{st.entreprise.intitule}} {% endif %} {% endif %}



                                  </td>
                         
                                  <td>{{ st.dateDebut ? st.dateDebut|date('d/m/Y') : '' }}</td>
                                  <td>{{ st.dateFin ? st.dateFin|date('d/m/Y') : '' }}</td>
                                  <td>{{ st.typeStage ? st.typeStage.libelle }}</td>
                                  <td>{{ st.dateEnvoie ? st.dateEnvoie|date('d/m/Y') : '' }}</td>
                                  <td>


                                    {% if st.statut == -1 %} 
                                           <label style="color:black;font-weight:bold;"> {{'encours'|trans}}</label>  
                                    {% endif %}

                                     {% if st.statut == -2 %} 
                                          <label style="color:black;font-weight:bold;"> {{'encours_sign'|trans}}</label>     
                                    {% endif %}


                                    {% if st.statut == 0 %} 
                                           <label style="color:red;font-weight:bold;"> {{'refuse'|trans}}</label>    
                                    {% endif %}

                                      {% if st.statut == 1 %} 
                                          <label style="color:green;font-weight:bold;"> {{'accorde'|trans}}</label>     
                                    {% endif %}
                                      
                                  
                                  </td>
                                  <td>

                          {% if st.niveau == 0 %} 
                              {{'ch_filiere'|trans}} 
                          {% else %}
                              {{'service_coop'|trans}}
                          {% endif %}
                                  
                                  </td>
                                  <td>{{st.motif}}</td> 
                                  <td class="hidden-print">
                                    <div class="text-center">
                                      <a class="btn  btn-xs" data-toggle="tooltip" data-placement="top" title="modifier" href="{{ path('editStage', { 'id': st.id }) }}"><span class="bi bi-pencil-square text-success"></span></a>      
                                    </div>
                                  </td> 
                                </tr>
                              {% endfor %}
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                     </div>
                    </div>
                 </div>
              </div><!--end row-->
    
    {% endblock %}  
    {% block javascripts %}
      {{parent()}}
      <script src="{{ asset('uploads/js/jquery-3.6.0.min.js') }}"></script>	    	
      <script src="{{ asset('uploads/js/moment-with-locales.min.js')}}"></script>
      <script src="{{ asset('uploads/js/bootstrap-material-datetimepicker.min.js')}}"></script>
      {{ encore_entry_script_tags('stage') }}
      <script>
        $(document).ready(function() {
          $('.js-dateDebut').bootstrapMaterialDatePicker({ time: false, lang: 'fr-FR'});
          $('.js-dateFin').bootstrapMaterialDatePicker({ time: false, lang: 'fr-FR'});
        });
        
      </script>
      
  
    {% endblock %}   